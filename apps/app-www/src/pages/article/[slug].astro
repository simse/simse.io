---
import { getArticleBySlug } from "src/lib/cms";

import Article from "@layouts/Article.astro";
import BlocksContent from "@components/BlocksContent";
import SlateToHtml from "@components/SlateToHtml.astro";

const { slug } = Astro.params;

const article = await getArticleBySlug(slug);

// redirect to 404 if no article found
if (!article.content) {
  Astro.redirect("/404", 302);
}
---

<Article article={article}>
  {article.contentBlocks && article.contentBlocks.length > 0 && (
    <BlocksContent blocks={article.contentBlocks} />
  )}

  {article.content && <SlateToHtml children={article.content} />}
</Article>