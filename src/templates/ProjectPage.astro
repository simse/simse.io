---
import { type CollectionEntry } from 'astro:content'
import Navbar from '@components/Navbar.astro'
import Footer from '@components/common/Footer.astro'
import ImageCarousel from '@components/common/ImageCarousel.astro'
import Downloads from '@components/projects/Downloads.svelte'
import Text from '@components/text/Text.astro'
import BaseLayout from '@layouts/BaseLayout.astro'

interface Props {
  project: CollectionEntry<'projects'>['data']
}

const { project }: Props = Astro.props
---

<BaseLayout title={project.title} canonical={`/${project.slug}`}>
  <Navbar activeItem="Projects" />

  <main class="max-w-4xl mx-auto pt-8 px-2 pb-12">
    <header class="mb-8">
      <h1 class="text-2xl md:text-3xl mb-2">{project.title}</h1>
      <span class="text-lg text-black/70 dark:text-white/70"
        >{project.description}</span
      >
    </header>

    {project.images && project.images.length > 0 && <ImageCarousel images={project.images} />}

    <section class="mb-8">
      <h2 class="text-lg mb-2">Key Information</h2>

      <table class="col-span-3 w-96 bg-zinc-900 rounded-lg overflow-clip">
        {
          project.languages.length > 0 && (
            <tr class="border-b border-black/20 dark:border-white/20 last:border-transparent">
              <td class="py-3 px-3 font-bold w-32">
                Language{project.languages.length > 1 && 's'}
              </td>
              <td class="py-3 px-3">{project.languages.join(', ')}</td>
            </tr>
          )
        }

        {
          project.technologies.length > 0 && (
            <tr class="border-b border-black/20 dark:border-white/20 last:border-transparent">
              <td class="py-3 px-3 font-bold w-32">
                Technolog{project.technologies.length > 1 ? 'ies' : 'y'}
              </td>
              <td class="py-3 px-3">{project.technologies.join(', ')}</td>
            </tr>
          )
        }
        {
          project.sourceCode && (
            <tr class="border-b last:border-transparent border-black/20 dark:border-white/20">
              <td class="py-3 px-3 font-bold">Source Code</td>
              <td class="py-3 px-3">
                <a
                  href={project.sourceCode}
                  class="text-purple-400 hover:text-purple-500 hover:border-purple-500 border-purple-400 border-b transition-colors"
                  target="_blank"
                  rel="noopener noreferrer"
                >
                  {project.sourceCode.replace('https://', '')}
                </a>
              </td>
            </tr>
          )
        }
        {
          project.demo && (
            <tr class="border-b last:border-transparent border-black/20 dark:border-white/20">
              <td class="py-3 px-3 font-bold">Demo</td>
              <td class="py-3 px-3">
                <a
                  href={project.demo}
                  class="text-purple-400 hover:text-purple-500 hover:border-purple-500 border-purple-400 border-b transition-colors"
                  target="_blank"
                  rel="noopener noreferrer"
                >
                  {project.demo.replace('https://', '')}
                </a>
              </td>
            </tr>
          )
        }
        <Downloads projectSlug={project.slug} client:load />
      </table>
    </section>

    <section class="mb-8">
      <Text content={project.details} />
    </section>
  </main>

  <Footer />
</BaseLayout>
