---
import client from '@lib/client'
import BlogPostPage from '@templates/BlogPostPage.astro'
import ProjectPage from '@templates/ProjectPage.astro'

const { slug } = Astro.params

if (!slug) {
  return Astro.rewrite('/404')
}

// try to get post
const post = await client.api
  .posts({
    slug,
  })
  .get()

// try to get project
const project = await client.api
  .projects({
    slug,
  })
  .get()

if (!post.data && !project.data) return Astro.rewrite('/404')
---
{post && post.data && <BlogPostPage post={post.data} />}
{project && project.data && <ProjectPage project={project.data} />}
